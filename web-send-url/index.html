<!DOCTYPE HTML>
<html>
	<head>
		<title>Spacebrew Image Viewer</title>
		<meta charset="utf-8">
		<link rel="stylesheet" href="css/style.css" type="text/css" media="screen" charset="utf-8" />
		<!-- basic libraries -->
    <script type="text/javascript" src="../jslib/jq-1.7.min.js"></script>
    <script type="text/javascript" src="../jslib/sb-1.4.1.min.js"></script>
<script type="text/javascript">
$(document).ready( function() {
	setup();
});

var sb;
function setupSB(){
  sb = new Spacebrew.Client(undefined,
                            undefined,
                            'A simple image viewer',
                            {debug: true});
  sb.addPublish('image', 
                'url', 
                'http://thissongissick.com/blog/wp-content/uploads/2011/05/Hall-and-Oates-Dj-Kue-Remix.jpg');
  sb.addPublish('cover', 'boolean', 'true');

  sb.onOpen = function onOpen(){
    console.log("WebSockets connection opened");
  };
  sb.onClose = function onClose(){
    console.log("WebSockets connection closed");
  };
  
  sb.connect();
}


//-------------------------------------------------------
var ddl, txt, chk;
function setup (){
  ddl = document.getElementById("ddlImg");
  txt = document.getElementById("txtImg");
  document.getElementById("btnImg").addEventListener('click',function(e){
    if (e){e.preventDefault();} sendImg();});
  ddl.onchange = function(){
    txt.value = ddl.options[ddl.selectedIndex].value;
    sendImg();
  }
  txt.onchange = sendImg;
  chk = document.getElementById("chkCover");
  chk.addEventListener('click', sendCover);
  setupSB();
}

function sendCover(){
  sb.send('cover', 'boolean', chk.checked.toString());
};

function sendImg(){
  sb.send('image', 'url', txt.value);
};

</script>
	</head>
	<body>
    <select id="ddlImg">
      <option value="http://thissongissick.com/blog/wp-content/uploads/2011/05/Hall-and-Oates-Dj-Kue-Remix.jpg">1</option>
      <option value="http://www.twilio.com/blog/wp-content/uploads/2011/12/4771-hall-2.jpg">2</option>
    </select>
    <input type="text" id="txtImg" />
    <input type="button" id="btnImg" />
    cover: <input type="checkbox" id="chkCover" />
  </body>
</html>
